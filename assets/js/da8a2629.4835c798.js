"use strict";(self.webpackChunksecurity_basics_lab=self.webpackChunksecurity_basics_lab||[]).push([[4020],{3194:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"challenge/rbac","title":"\ud83d\udc50 RUN : RBAC challenge","description":"The provided scripts are incomplete. Replace all `` with the correct code to complete the lab.","source":"@site/docs/challenge/rbac.mdx","sourceDirName":"challenge","slug":"/challenge/rbac","permalink":"/security-basics-lab/docs/challenge/rbac","draft":false,"unlisted":false,"editUrl":"https://github.com/mongodb-developer/security-basics-lab/blob/main/docs/challenge/rbac.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Role-Based Access Control","permalink":"/security-basics-lab/docs/rbac/"},"next":{"title":"Queryable Encryption","permalink":"/security-basics-lab/docs/queryable-encryption/"}}');var n=a(4848),r=a(8453);const l={sidebar_position:2},o="\ud83d\udc50 RUN : RBAC challenge",d={},c=[{value:"1. Create a user for &quot;MyNewCluster&quot; database only",id:"1-create-a-user-for-mynewcluster-database-only",level:3},{value:"2. Create user with read-only access to the &#39;salesDB&#39; database",id:"2-create-user-with-read-only-access-to-the-salesdb-database",level:3},{value:"3. Test that &#39;salesReadUser&#39; cannot insert data into the &#39;salesDB&#39; database.",id:"3-test-that-salesreaduser-cannot-insert-data-into-the-salesdb-database",level:3},{value:"4. Test that &#39;myNewClusterAdmin&#39; can insert data into the &#39;salesDB&#39; database.",id:"4-test-that-mynewclusteradmin-can-insert-data-into-the-salesdb-database",level:3},{value:"Next Steps",id:"next-steps",level:2}];function i(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components},{Details:a}=s;return a||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"-run--rbac-challenge",children:"\ud83d\udc50 RUN : RBAC challenge"})}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsxs)(s.p,{children:["The provided scripts are incomplete. Replace all ",(0,n.jsx)(s.code,{children:"<CODE_BLOCK>"})," with the correct code to complete the lab."]})})}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsxs)(s.p,{children:["Hint: Remember to add ",(0,n.jsx)(s.code,{children:"--projectId {project_id}"}),"\nRefer to documentations : ",(0,n.jsx)(s.a,{href:"https://www.mongodb.com/docs/atlas/cli/current/command/atlas-dbusers-create/",children:"atlas dbusers"})," , ",(0,n.jsx)(s.a,{href:"https://www.mongodb.com/docs/atlas/cli/current/command/atlas-customDbRoles-create/",children:"atlas customDbRoles"})]})}),"\n",(0,n.jsx)(s.h3,{id:"1-create-a-user-for-mynewcluster-database-only",children:'1. Create a user for "MyNewCluster" database only'}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"# Create a user:'myNewClusterAdmin', password:'myNewClusterAdminPass', role: 'readWriteAnyDatabase'\n# and scoped to \"MyNewCluster\" database\nnewClusterAdminUser = 'myNewClusterAdmin'\nnewClusterAdminPass = 'myNewClusterAdminPass'\n!atlas dbusers create <CODE_BLOCK>\n"})}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsxs)(a,{children:[(0,n.jsx)("summary",{children:" Answer "}),(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"# Create a user:'myNewClusterAdmin', password:'myNewClusterAdminPass', role: 'readWriteAnyDatabase'\n# and scoped to \"MyNewCluster\" database\nnewClusterAdminUser = 'myNewClusterAdmin'\nnewClusterAdminPass = 'myNewClusterAdminPass'\n!atlas dbusers create --username {newClusterAdminUser} --password {newClusterAdminPass} --role readWriteAnyDatabase --scope 'MyNewCluster' --projectId {project_id} \n"})})]})}),"\n",(0,n.jsx)(s.h3,{id:"2-create-user-with-read-only-access-to-the-salesdb-database",children:"2. Create user with read-only access to the 'salesDB' database"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'#Create a role "salesRead" which access to read-only role to salesDB database\n!atlas customDbRoles create <CODE_BLOCK>\n\n#Create a user "salesReadUser" with password "salesReadPass" which has the "salesRead" role\nsalesReadUser = \'salesReadUser\'\nsalesReadPass = \'salesReadPass\'\n!atlas dbusers create <CODE_BLOCK>\n'})}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsxs)(a,{children:[(0,n.jsx)("summary",{children:" Answer "}),(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'#Create a role "salesRead" which access to read-only role to salesDB database\n!atlas customDbRoles create salesRead --inheritedRole read@salesDB --projectId {project_id}\n\n#Create a user "salesReadUser" with password "salesReadPass" which has the "salesRead" role\nsalesReadUser = \'salesReadUser\'\nsalesReadPass = \'salesReadPass\'\n!atlas dbusers create --username salesReadUser --password salesReadPass --role salesRead --projectId {project_id}\n'})})]})}),"\n",(0,n.jsx)(s.h3,{id:"3-test-that-salesreaduser-cannot-insert-data-into-the-salesdb-database",children:"3. Test that 'salesReadUser' cannot insert data into the 'salesDB' database."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"# Get connection string\nconnection = !atlas clusters connectionStrings describe MyNewCluster --projectId {project_id}\n\n# Replace connection string with username and password\nnew_connection = connection[1].replace('mongodb+srv://', f'mongodb+srv://{salesReadUser}:{salesReadPass}@')\n\n# Attempt to insert data\nclient = MongoClient(new_connection)\ndb = client['salesDB']\ncollection = db['mycollection']\ntry:\n  data = {'name': 'John Doe', 'age': 30}\n  result = collection.insert_one(data)\n  print(f\"Inserted document with ID: {result.inserted_id}\")\nexcept Exception as e:\n  print(f\"Error inserting data: {e}\")\n"})}),"\n",(0,n.jsx)(s.h3,{id:"4-test-that-mynewclusteradmin-can-insert-data-into-the-salesdb-database",children:"4. Test that 'myNewClusterAdmin' can insert data into the 'salesDB' database."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"# Get connection string\nconnection = !atlas clusters connectionStrings describe MyNewCluster --projectId {project_id}\n\n# Replace connection string with username and password\nnew_connection = connection[1].replace('mongodb+srv://', f'mongodb+srv://{newClusterAdminUser}:{newClusterAdminPass}@')\n\n# Attempt to insert data\nclient = MongoClient(new_connection)\ndb = client['salesDB']\ncollection = db['mycollection']\ntry:\n  data = {'name': 'John Doe', 'age': 30}\n  result = collection.insert_one(data)\n  print(f\"Inserted document with ID: {result.inserted_id}\")\nexcept Exception as e:\n  print(f\"Error inserting data: {e}\")\n"})}),"\n",(0,n.jsx)(s.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,n.jsxs)(s.p,{children:["Start the chapter on ",(0,n.jsx)(s.a,{href:"./queryable-encryption",children:"Queryable Encryption"})," for data encryption."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(i,{...e})}):i(e)}}}]);